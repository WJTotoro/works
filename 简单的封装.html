<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>事件的封装</title>
</head>
<body>
<script type="text/javascript"> 

var eventUlti = {
  addHandler:function(element,type,handler){
    if(element.addEventListener){
      element.addEventListener(type,handler,false);
    }
    else if(element.attachEvent){
      element.attachEvent("on"+type,handler);
    }
    else{
      element["on"+type] = handler;
    }
  },

  removeHandler:function(element,type,handler){
    if(element.removeEventListener){
      element.removeEventListener(type,handler,false);
    }
    else if(element.detachEvent){
      element.detachEvent("on"+type,handler);
    }
    else{
      element["on"+type]=null;
    }
  },

     preventDefault:function(e){
      if(e.preventDefault){
        e.preventDefault();
      }
      else{
        e.returnValue = false;
      }
    },

    stopPropagation:function(e){
      if(e.stopPropagation){
        e.stopPropagation();
      }
      else{
        e.cancelBubble = true;
      }
    },

    getType : function(e){
      return e.type;
    },

    getTarget: function(e){
      return target||e.srcElement;
    },
     
    getEvent: function(e){
      return e || window.event;
    },
     

    getNames :function(el){
      if(el.length<1){  // 空字符串
        return;
      }
      var sub = el.substring(1);
      if(el[0]==="#"){
        return document.getElementById("sub");
      }else if(el[0]==="."){
        return document.getElementByClassName("sub");
      }else{
        return document.getElementByTagName(el);
      }
    },

    hasClass:function(ele,cls){
       return !!ele.className.match(new RegExp("\\b"+cls+"\\b"));
    },

    addClass:function(ele,cls){
      if(ele.length && ele.length>0){
        for(var i=0;i<ele.length;i++){
          eventUlti.singleAddClass(ele[i],cls);
        }
      }else{
        eventUlti.singleAddClass(ele,cls);
      }
    },
     
    removeClass:function(ele,cls){
      if(ele.length&&ele.length>0){
        for(var i=0;i<ele.length;i++){
          eventUlti.singleRemoveClass(ele[i],cls);
        }
      }else{
        eventUlti.singleRemoveClass(ele,cls);
      }
    },

    singleAddClass:function(ele,cls){
      if(eventUlti.hasClass(ele,cls)) return;
      ele.className += ""+cls;
    },

    singleRemoveClass:function(ele,cls){
      ele.className = ele.className.replace(new RegExp("\\b"+cls+"\\b","g"),"");
    },

    indexOf:function(ele){
      var parent = ele.parentElement,
          siblings = parent.children;
          for(var i=0;i<siblings.length;i++){
            if(ele===siblings[i]) return i;
          }
          return -1;
    },

 ajax:function(opts){
      var xhr = new XMLHttpRequest();
      xhr.onreadystatechange = function(){
        if(xhr.readyState==4&&xhr.status==200){
          var json = JSON.parse(xhr.responseText);
          opts.success(json);
        }
        if(xhr.status==404){
          opts.error();
        }
      }

        var dataStr = "";
      for(var key in opts.data){
        dataStr += key + "=" + opts.data[key] + "&";
      }
      dataStr = dataStr.substr(0,dataStr.length-1);

      if(opts.type.toLowerCase()==="get"){
        xhr.open(opts.type,opts.url+"?"+dataStr,true);
        xhr.send();
      }

      if(opts.type.toLowerCase()==="post"){
        xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");
          xhr.open(opts.type,opts.url,true);
        xhr.send(dataStr);
      }
    
    },



}

   </script>
</body> 
</html>